(function(e,t,n){var r=qc.defineBehaviour("qc.Plugins.NodeFadeInOut",qc.Tween,function(){this.fadeType=r.FADE_IN,this.columnCount=1,this.rowCount=1,this.pivotX=.5,this.pivotY=.5,this.fadeStyle=r.STYLE_ZOOM,this.fadeEffect=r.EFFECT_XY,this.target=null},{fadeType:qc.Serializer.NUMBER,columnCount:qc.Serializer.NUMBER,rowCount:qc.Serializer.NUMBER,pivotX:qc.Serializer.NUMBER,pivotY:qc.Serializer.NUMBER,fadeStyle:qc.Serializer.NUMBER,fadeEffect:qc.Serializer.NUMBER,target:qc.Serializer.NODE});r.__menu="Plugins/NodeFadeInOut",t.defineProperties(r.prototype,{columnCount:{get:function(){return this._columnCount},set:function(e){e=isNaN(e)||e===0?1:e;if(e===this._columnCount)return;this._columnCount=e}},rowCount:{get:function(){return this._rowCount},set:function(e){e=isNaN(e)||e===0?1:e;if(e===this._rowCount)return;this._rowCount=e}},_cachedTarget:{get:function(){return this.target&&this.target._destroy&&(this.target=null),this.target||this.gameObject}}}),r.prototype.onEnable=function(){var e=this;if(e._cachedTarget._destroy)return;e._cachedTarget.visible=!0,e._cachedTexture&&(e._cachedTexture.destroy(!0),e._cachedTexture=null),e._cachedBounds=e._cachedTarget.localBounds,e._cachedTexture=e._cachedTarget.generateTexture(),e._cachedSprite=new PIXI.Sprite(e._cachedTexture),e._cachedSprite.worldTransform=e._cachedTarget.worldTransform,e._cachedTarget.phaser.anchor&&(e._cachedSprite.anchor=e._cachedTarget.phaser.anchor),e._nodeRenderCanvas||(e._nodeRenderCanvas=e.gameObject.phaser._renderCanvas,e.gameObject.phaser._renderCanvas=e.renderCanvas.bind(this),e.gameObject.phaser.getSelfWidth=function(){return e._cachedSprite.width},e.gameObject.phaser.getSelfHeight=function(){return e._cachedSprite.height},e.gameObject.phaser._skipChildrenRender=!0),e._nodeRenderWebGL||(e._nodeRenderWebGL=e.gameObject.phaser._renderWebGL,e.gameObject.phaser._renderWebGL=e.renderWebGL.bind(this))},r.prototype.onDisable=function(){this._nodeRenderCanvas&&(this.gameObject.phaser._renderCanvas=this._nodeRenderCanvas,this._nodeRenderCanvas=null),this._nodeRenderWebGL&&(this.gameObject.phaser._renderWebGL=this._nodeRenderWebGL,this._nodeRenderWebGL=null,this.gameObject.phaser.getSelfWidth=null,this.gameObject.phaser.getSelfHeight=null,this.gameObject.phaser._skipChildrenRender=!1),this._cachedTexture&&(this._cachedTexture.destroy(!0),this._cachedTexture=null),this._cachedSprite&&(this._cachedSprite=null),qc.Tween.prototype.onDisable.call(this)},r.prototype.onDestroy=function(){this._nodeRenderCanvas&&(this.gameObject.phaser._renderCanvas=this._nodeRenderCanvas,this._nodeRenderCanvas=null),this._nodeRenderWebGL&&(this.gameObject.phaser._renderWebGL=this._nodeRenderWebGL,this._nodeRenderWebGL=null),this._cachedTexture&&(this._cachedTexture.destroy(!0),this._cachedTexture=null),this._cachedSprite&&(this._cachedSprite=null),qc.Tween.prototype.onDestroy&&qc.Tween.prototype.onDestroy.call(this)},r.prototype.onUpdate=function(e,t){this._factorValue=this.fadeType===r.FADE_IN?1-e:e,this.gameObject.phaser.displayChanged(qc.DisplayChangeStatus.TEXTURE|qc.DisplayChangeStatus.SIZE),t&&!this._cachedTarget._destroy&&this._cachedTarget===this.gameObject&&(this._cachedTarget.visible=this.fadeType===r.FADE_IN)},r.prototype.renderCanvas=function(e){this._cachedTarget!==this.gameObject&&this._nodeRenderCanvas.call(this.gameObject.phaser,e);var t=this._cachedTexture,n=this._cachedSprite,i=this._cachedBounds;if(t){var s=t.baseTexture.resolution/e.resolution;e.context.globalAlpha=n.worldAlpha,e.smoothProperty&&e.scaleMode!==t.baseTexture.scaleMode&&(e.scaleMode=t.baseTexture.scaleMode,e.context[e.smoothProperty]=e.scaleMode===PIXI.scaleModes.LINEAR);var o=t.trim?t.trim.x-n.anchor.x*t.trim.width:n.anchor.x*-t.frame.width,u=t.trim?t.trim.y-n.anchor.y*t.trim.height:n.anchor.y*-t.frame.height;e.roundPixels?(e.context.setTransform(n.worldTransform.a,n.worldTransform.b,n.worldTransform.c,n.worldTransform.d,n.worldTransform.tx*e.resolution|0,n.worldTransform.ty*e.resolution|0),o|=0,u|=0):e.context.setTransform(n.worldTransform.a,n.worldTransform.b,n.worldTransform.c,n.worldTransform.d,n.worldTransform.tx*e.resolution,n.worldTransform.ty*e.resolution);var a=t.crop.width/this.columnCount,f=t.crop.height/this.rowCount,l=this.fadeEffect===r.EFFECT_X||this.fadeEffect===r.EFFECT_XY,c=this.fadeEffect===r.EFFECT_Y||this.fadeEffect===r.EFFECT_XY,h=(l?1-this._factorValue:1)*a/s,p=(c?1-this._factorValue:1)*f/s,d=l&&this.fadeStyle===r.STYLE_CLIP?a*(1-this._factorValue):a,v=c&&this.fadeStyle===r.STYLE_CLIP?f*(1-this._factorValue):f;for(var m=0;m<t.crop.height;m+=f){var g=(u+m+f*(c?this._factorValue:0)*this.pivotY)/s+i.y;for(var y=0;y<t.crop.width;y+=a){var b=(o+y+a*(l?this._factorValue:0)*this.pivotX)/s+i.x;e.context.drawImage(t.baseTexture.source,t.crop.x+y,t.crop.y+m,d,v,b,g,h,p)}}}},r.prototype.renderWebGL=function(e){this._cachedTarget!==this.gameObject&&this._nodeRenderWebGL.call(this.gameObject.phaser,e);var t=this._cachedTexture,n=this._cachedBounds,i=this._cachedSprite,s=t._uvs;if(!s)return;var o=t.baseTexture.resolution/e.resolution,u=t.crop.width/this.columnCount,a=t.crop.height/this.rowCount,f=this.fadeEffect===r.EFFECT_X||this.fadeEffect===r.EFFECT_XY,l=this.fadeEffect===r.EFFECT_Y||this.fadeEffect===r.EFFECT_XY,c=(f?1-this._factorValue:1)*u/o,h=(l?1-this._factorValue:1)*a/o,p=f&&this.fadeStyle===r.STYLE_CLIP?u*(1-this._factorValue):u,d=l&&this.fadeStyle===r.STYLE_CLIP?a*(1-this._factorValue):a,v=i.worldTransform,m=v.a/o,g=v.b/o,y=v.c/o,b=v.d/o,w=v.tx,E=v.ty,S=s.x2-s.x0,x=s.y2-s.y0;for(var T=0;T<t.crop.height;T+=a){var N=(T+a*(l?this._factorValue:0)*this.pivotY)/o+n.y;for(var C=0;C<t.crop.width;C+=u){var k=(C+u*(f?this._factorValue:0)*this.pivotX)/o+n.x;this._webGLAddQuad(e.spriteBatch,i,k,N,k+c,N+h,s.x0+S*C/t.crop.width,s.y0+x*T/t.crop.height,s.x0+S*(C+p)/t.crop.width,s.y0+x*(T+d)/t.crop.height,m,g,y,b,w,E,i.tint)}}},r.prototype._webGLAddQuad=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){e.currentBatchSize>=e.size&&(e.flush(),e.currentBaseTexture=t.texture.baseTexture);var g=e.colors,y=e.positions,b=e.currentBatchSize*4*e.vertSize;e.renderSession.roundPixels?(y[b]=l*n+h*r+d|0,y[b+1]=p*r+c*n+v|0,y[b+5]=l*i+h*r+d|0,y[b+6]=p*r+c*i+v|0,y[b+10]=l*i+h*s+d|0,y[b+11]=p*s+c*i+v|0,y[b+15]=l*n+h*s+d|0,y[b+16]=p*s+c*n+v|0):(y[b]=l*n+h*r+d,y[b+1]=p*r+c*n+v,y[b+5]=l*i+h*r+d,y[b+6]=p*r+c*i+v,y[b+10]=l*i+h*s+d,y[b+11]=p*s+c*i+v,y[b+15]=l*n+h*s+d,y[b+16]=p*s+c*n+v),y[b+2]=o,y[b+3]=u,y[b+7]=a,y[b+8]=u,y[b+12]=a,y[b+13]=f,y[b+17]=o,y[b+18]=f,g[b+4]=g[b+9]=g[b+14]=g[b+19]=(m>>16)+(m&65280)+((m&255)<<16)+(t.worldAlpha*255<<24),e.sprites[e.currentBatchSize++]=t},r.FADE_IN=0,r.FADE_OUT=1,r.STYLE_ZOOM=0,r.STYLE_CLIP=1,r.EFFECT_XY=0,r.EFFECT_X=1,r.EFFECT_Y=2;var i=qc.defineBehaviour("qc.TweenFunction",qc.Tween,function(){var e=this;e.funcName="",e.func=null,e.funcContext=null,e.enable=!1},{funcName:qc.Serializer.STRING});i.__menu="Plugins/TweenFunction",t.defineProperties(i.prototype,{funcName:{get:function(){return this._funcName},set:function(e){if(e===this._funcName)return;this._funcName=e,this.onEnable()}}}),i.prototype.onEnable=function(){if(this._funcName.length<=0)return;this.func=this.gameObject[this._funcName];var t=[];this.func&&(t.push(this.gameObject.class),this.func=this.func.bind(this.gameObject));var n=this;this.gameObject.scripts.forEach(function(e){var r=e[n._funcName];r&&(t.push(e.class),n.func=r.bind(e))}),!n.func&&this.enable&&this.game.log.important("TweenFunction({0}) not find!",this._funcName);if(t.length<=1)return;n.game.log.error("Error: Exist multi functions with same name: {0}",t);if(n.game.device.editor===!0){var r=e.parent&&e.parent.G;if(r){var i=r._("TweenFunction func error")+t;r.notification.error(i)}}},i.prototype.onUpdate=function(e,t){if(typeof this.func!="function")return;if(this.duration==0&&!t)return;this.func(e,this.duration)},i.begin=function(e,t,n){var r=qc.Tween.begin("qc.TweenFunction",e,t);return r.funcName=n,r};var s=function(t){var n=t.split("."),r=e;for(var i=0;i<n.length;i++)r[n[i]]||(r[n[i]]={}),r=r[n[i]]};s("com.qici.extraUI");var o=qc.ScrollView,u=com.qici.extraUI.ScrollSupport=function(e,t,n,r,i){this.game=e,this.node=t,this._getViewRect=n,this._getContentRect=r,this._setContentPosition=i,this.canHorizontal=!0,this.canVertical=!0,this.movementType=o.MOVEMENT_ELASTIC,this.elasticity=1,this.inertia=!0,this.decelerationRate=.03,this.scrollSensitivity=1,this.propagationScroll=!1,this.onValueChange=new Phaser.Signal,this._preContentPosition=null,this._preContentRect=null,this._preViewRect=null,this._velocity=new qc.Point(0,0),this._isDragging=!1,this.pivotX=0,this.pivotY=0,this.node&&(this.node.onWheel.add(this._doWheel,this),this.node.onDragStart.add(this._doDragStart,this),this.node.onDrag.add(this._doDrag,this),this.node.onDragEnd.add(this._doDragEnd,this))};u.prototype={},u.prototype.constructor=u,t.defineProperties(u.prototype,{horizontalScrollBar:{get:function(){return this._horizontalScrollBar&&this._horizontalScrollBar._destroy&&(this._horizontalScrollBar=null),this._horizontalScrollBar},set:function(e){this._horizontalScrollBar&&this._horizontalScrollBar.onValueChange.remove(this._setHorizontalNormalizedPosition,this),this._horizontalScrollBar=e,this._horizontalScrollBar&&this._horizontalScrollBar.onValueChange.add(this._setHorizontalNormalizedPosition,this)}},verticalScrollBar:{get:function(){return this._verticalScrollBar&&this._verticalScrollBar._destroy&&(this._verticalScrollBar=null),this._verticalScrollBar},set:function(e){this._verticalScrollBar&&this._verticalScrollBar.onValueChange.remove(this._setVerticalNormalizedPosition,this),this._verticalScrollBar=e,this._verticalScrollBar&&this._verticalScrollBar.onValueChange.add(this._setVerticalNormalizedPosition,this)}},horizontalNormalizedPosition:{get:function(){return this._updateBounds(),this._contentRect.width<=this._viewRect.width?this._viewRect.x>this._contentRect.x?1:0:(this._viewRect.x-this._contentRect.x)/(this._contentRect.width-this._viewRect.width)},set:function(e){this.setNormalizedPosition(e,0)}},verticalNormalizedPosition:{get:function(){return this._updateBounds(),this._contentRect.height<=this._viewRect.height?this._viewRect.y>this._contentRect.y?1:0:(this._viewRect.y-this._contentRect.y)/(this._contentRect.height-this._viewRect.height)},set:function(e){this.setNormalizedPosition(e,1)}}}),u.prototype.destroy=function(){this.node&&(this.node.onWheel.remove(this._doWheel,this),this.node.onDragStart.remove(this._doDragStart,this),this.node.onDrag.remove(this._doDrag,this),this.node.onDragEnd.remove(this._doDragEnd,this)),this.node=null,this._setContentPosition=null,this._getContentRect=null,this._getViewRect=null,this.horizontalScrollBar=null,this.verticalScrollBar=null},u.prototype.update=function(e){this._updateVelocity(e)},u.prototype.getViewRect=function(){return this._getViewRect?this._getViewRect():new qc.Rectangle(0,0,0,0)},u.prototype.getContentRect=function(){return this._getContentRect?this._getContentRect():new qc.Rectangle(0,0,0,0)},u.prototype.setContentPosition=function(e,t){this._setContentPosition&&this._setContentPosition(e,t)},u.prototype._setHorizontalNormalizedPosition=function(e){this.setNormalizedPosition(e,0)},u.prototype._setVerticalNormalizedPosition=function(e){this.setNormalizedPosition(e,1)},u.prototype._calculateOffset=function(e,t){var n=new qc.Point(0,0);if(this.movementType===o.MOVEMENT_UNRESTRICTED)return n;var r=this.getViewRect(),i=this._contentRect,s=new qc.Point(i.x,i.y),u=new qc.Point(i.x+i.width,i.y+i.height);return this.canHorizontal&&(s.x+=e,u.x+=e,s.x>r.x?n.x=r.x-s.x:u.x<r.x+r.width&&(n.x=r.x+r.width-u.x)),this.canVertical&&(s.y+=t,u.y+=t,s.y>r.y?n.y=r.y-s.y:u.y<r.y+r.height&&(n.y=r.y+r.height-u.y)),n},u.prototype._calcVelocityEffect=function(e,t,n,r){if(this.movementType===o.MOVEMENT_ELASTIC&&t[r]!==0){var i=this["_lastOffset_"+r]||0;Math.abs(i)<Math.abs(t[r])?(this["_lastOffset_"+r]=t[r],this._currSmoothetTime=n):(this["_lastOffset_"+r]=t[r],this._currSmoothetTime+=n);var s=this.elasticity<=0?n:this.elasticity,u=this.game.math.smoothDamp(e[r],e[r]+t[r],this._velocity[r],this.elasticity,Number.MAX_VALUE,n/100);Math.abs(e[r]+t[r]-u[0])<1e-4?(e[r]=e[r]+t[r],this._velocity[r]=0):(e[r]=u[0],this._velocity[r]=u[1])}else if(this.movementType===o.MOVEMENT_CLAMPED&&t[r]!==0)e[r]=e[r]+t[r];else if(this.inertia){var a=this._velocity[r]*Math.pow(Math.abs(this.decelerationRate),n/1e3);Math.abs(a)<1&&(a=0),this._velocity[r]=a,e[r]=e[r]+a*n/1e3}else this._velocity[r]=0},u.prototype._rubberDelta=function(e,t){return(1-1/(Math.abs(e)*.55/t+1))*t*this.game.math.sign(e)},u.prototype._updateVelocity=function(e){var t,n;this._updateBounds();var r=this._calculateOffset(0,0);!this._isDragging&&(r.x!==0||r.y!==0||this._velocity.x!==0||this._velocity.y!==0)&&(t=this.getContentRect(),n=new qc.Point(t.x,t.y),this._calcVelocityEffect(n,r,e,"x"),this._calcVelocityEffect(n,r,e,"y"),(this._velocity.x!==0||this._velocity.y!==0)&&this.movementType===o.MOVEMENT_CLAMPED&&(r=this._calculateOffset(n.x-t.x,n.y-t.y),n.x+=r.x,n.y+=r.y),this.setContentPosition(n.x,n.y));if(this._isDragging&&this.inertia){t=this.getContentRect();var i=t.x-this._preContentPosition.x,s=t.y-this._preContentPosition.y,u=this.game.math.clamp(e/1e3,0,1);this._velocity.x=i/u,this._velocity.y=s/u}if(!this._preViewRect||!qc.Rectangle.equals(this._viewRect,this._preViewRect)||!this._preContentRect||!qc.Rectangle.equals(this._contentRect,this._preContentRect))this._updateScrollBars(r.x,r.y),this.onValueChange.dispatch(new qc.Point(this.horizontalNormalizedPosition,this.verticalNormalizedPosition)),this._updatePrevData()},u.prototype.setNormalizedPosition=function(e,t){this._updateBounds();if(!this._contentRect)return;var n=this.getContentRect(),r=t?"height":"width",i=t?"y":"x",s=this._contentRect[r]-this._viewRect[r],o=this._viewRect[i]-e*s,u=n[i]+o-this._contentRect[i],a=n[i];Math.abs(a-u)>1&&(n[i]=u,this.setContentPosition(n.x,n.y),this._velocity[i]=0,this._updateBounds())},u.prototype._updatePrevData=function(){var e=this.getContentRect();this._preContentPosition=new qc.Point(e.x,e.y),this._preContentRect=this._contentRect,this._preViewRect=this._viewRect},u.prototype._updateScrollBars=function(e,t){var n;this.horizontalScrollBar&&(this._contentRect.width>0?(n=(this._viewRect.width-Math.abs(e))/this._contentRect.width,this.horizontalScrollBar.size=Phaser.Math.clamp(n,0,1)):this.horizontalScrollBar.size=1,this.horizontalScrollBar.value=this.horizontalNormalizedPosition),this.verticalScrollBar&&(this._contentRect.height>0?(n=(this._viewRect.height-Math.abs(t))/this._contentRect.height,this.verticalScrollBar.size=Phaser.Math.clamp(n,0,1)):this.verticalScrollBar.size=1,this.verticalScrollBar.value=this.verticalNormalizedPosition)},u.prototype._updateBounds=function(){var e=this._viewRect=this.getViewRect();this._updateContentBounds();if(!this._getContentRect)return;var t=e.width-this._contentRect.width,n=e.height-this._contentRect.height;t>0&&(this._contentRect.width=e.width,this._contentRect.x-=t*this.pivotX),n>0&&(this._contentRect.height=e.height,this._contentRect.y-=n*this.pivotY)},u.prototype._updateContentBounds=function(){this._contentRect=this.getContentRect()},u.prototype._doWheel=function(e,t){this._updateBounds();var n=new qc.Point(t.source.deltaX,t.source.deltaY);this.canVertical||(n.y=0),this.canHorizontal||(n.x=0);var r=n.x*this.scrollSensitivity,i=n.y*this.scrollSensitivity;this.doScroll(r,i,!1)},u.prototype._doDragStart=function(e,t){if(t.source.eventId!==qc.Mouse.BUTTON_LEFT)return;this._updateBounds();var n=this.getContentRect();this._contentStartPosition=new qc.Point(n.x,n.y),this._pointerStartCursor=this.node.toLocal(new qc.Point(t.source.startX,t.source.startY)),this._isDragging=!0},u.prototype._doDragEnd=function(e,t){if(t.source.eventId!==qc.Mouse.BUTTON_LEFT)return;this._isDragging=!1},u.prototype._doDrag=function(e,t){if(t.source.eventId!==qc.Mouse.BUTTON_LEFT)return;this._updateBounds();var n=this.getContentRect(),r=this.node.toLocal(new qc.Point(t.source.x,t.source.y));if(!this._pointerStartCursor)return;var i=this.canHorizontal?r.x-this._pointerStartCursor.x:0,s=this.canVertical?r.y-this._pointerStartCursor.y:0;this.doScroll(this._contentStartPosition.x+i-n.x,this._contentStartPosition.y+s-n.y,!0)},u.prototype.doScroll=function(e,t,n){var r=this.getContentRect(),i=new qc.Point(r.x,r.y);i.x+=e,i.y+=t;var s=this._calculateOffset(e,t);i.x+=s.x,i.y+=s.y;if(this.movementType===o.MOVEMENT_CLAMPED&&this.propagationScroll){var u=this.parent;while(!(u instanceof o)&&u!==this.game.world)u=u.parent;u instanceof o&&u.doScroll(-s.x,-s.y,n)}else this.movementType===o.MOVEMENT_ELASTIC&&(n?(s.x!==0&&(i.x=i.x-this._rubberDelta(s.x,this._viewRect.width)),s.y!==0&&(i.y=i.y-this._rubberDelta(s.y,this._viewRect.height))):(i.x-=s.x,i.y-=s.y,Math.abs(s.x)>this._viewRect.width&&(i.x+=s.x-this.game.math.sign(s.x)*this._viewRect.width),Math.abs(s.y)>this._viewRect.height&&(i.y+=s.y-this.game.math.sign(s.y)*this._viewRect.height)));this.setContentPosition(i.x,i.y),n||this._updateBounds()};var a=qc.defineBehaviour("com.qici.extraUI.TableViewAdapter",qc.Behaviour,function(){var e=this;e.onDataChange=new qc.Signal},{});t.defineProperties(a.prototype,{}),a.prototype.dispatchDataChange=function(){this.onDataChange.dispatch()},a.prototype.getTableSize=function(){return{x:1,y:Infinity}},a.prototype.findCellWithPos=function(e,t){return{x:Math.floor(e/100),y:Math.floor(t/100)}},a.prototype.getCellRect=function(e,t){return new qc.Rectangle(e*100,t*100,100,100)},a.prototype.revokeCell=function(e,t,n){},a.prototype.createCell=function(e,t,n){};var f=qc.defineBehaviour("com.qici.extraUI.TableView",qc.Behaviour,function(){var e=this;e._cellPool=[],e._usingCell=[],e._showRect=new qc.Rectangle(0,0,0,0),e.scrollSupport=new com.qici.extraUI.ScrollSupport(e.game,e.gameObject,e._getViewRect.bind(e),e._getContentRect.bind(e),e._setContentPosition.bind(e)),e.runInEditor=!0},{content:qc.Serializer.NODE,adapterNode:qc.Serializer.NODE,horizontalScrollBar:qc.Serializer.NODE,verticalScrollBar:qc.Serializer.NODE,cellPrefab:qc.Serializer.PREFAB,overflow:qc.Serializer.BOOLEAN,canHorizontal:qc.Serializer.BOOLEAN,canVertical:qc.Serializer.BOOLEAN,movementType:qc.Serializer.NUMBER,elasticity:qc.Serializer.NUMBER,inertia:qc.Serializer.BOOLEAN,decelerationRate:qc.Serializer.NUMBER,scrollSensitivity:qc.Serializer.NUMBER,propagationScroll:qc.Serializer.BOOLEAN,extraLeft:qc.Serializer.NUMBER,extraRight:qc.Serializer.NUMBER,extraTop:qc.Serializer.NUMBER,extraBottom:qc.Serializer.NUMBER});t.defineProperties(f.prototype,{adapterNode:{get:function(){return this._adapterNode||this.gameObject},set:function(e){if(e===this._adapterNode)return;this._adapterNode=e,this._adapter&&(this._adapter.onDataChange.remove(this._clearTable,this),this._adapter=null),this._needRebuild=!0}},adapter:{get:function(){return this._adapter||(this._adapter=this.adapterNode&&this.adapterNode.getScript("com.qici.extraUI.TableViewAdapter"),this._adapter&&this._adapter.onDataChange.add(this._clearTable,this)),this._adapter}},content:{get:function(){return this._content&&this._content._destroy&&(this.content=null),this._content},set:function(e){var t=this;t._content&&(t._content.onChildrenChanged.remove(t._doChildrenChanged,t),t._content.onLayoutArgumentChanged.remove(t._doLayoutArgumentChanged,t)),t._content=e,t._needRebuild=!0,t._content&&(t._content.onChildrenChanged.add(t._doChildrenChanged,t),t._content.onLayoutArgumentChanged.add(t._doLayoutArgumentChanged,t))}},cellPrefab:{get:function(){return this._cellPrefab},set:function(e){if(e===this._cellPrefab)return;this._cellPrefab=e,this.content&&this.content.removeChildren(),this._cellPool=[],this._needRebuild=!0}},overflow:{get:function(){return this._overflow},set:function(e){if(e===this._overflow)return;this._overflow=e,this._needRebuild=!0}},extraLeft:{get:function(){return this._extraLeft||0},set:function(e){if(e===this._extraLeft)return;this._extraLeft=e,this._needRebuild=!0}},extraRight:{get:function(){return this._extraRight||0},set:function(e){if(e===this._extraRight)return;this._extraRight=e,this._needRebuild=!0}},extraTop:{get:function(){return this._extraTop||0},set:function(e){if(e===this._extraTop)return;this._extraTop=e,this._needRebuild=!0}},extraBottom:{get:function(){return this._extraBottom||0},set:function(e){if(e===this._extraBottom)return;this._extraBottom=e,this._needRebuild=!0}},canHorizontal:{get:function(){return this.scrollSupport?this.scrollSupport.canHorizontal:null},set:function(e){this.scrollSupport&&(this.scrollSupport.canHorizontal=e)}},canVertical:{get:function(){return this.scrollSupport?this.scrollSupport.canVertical:null},set:function(e){this.scrollSupport&&(this.scrollSupport.canVertical=e)}},movementType:{get:function(){return this.scrollSupport?this.scrollSupport.movementType:null},set:function(e){this.scrollSupport&&(this.scrollSupport.movementType=e)}},elasticity:{get:function(){return this.scrollSupport?this.scrollSupport.elasticity:null},set:function(e){this.scrollSupport&&(this.scrollSupport.elasticity=e)}},inertia:{get:function(){return this.scrollSupport?this.scrollSupport.inertia:null},set:function(e){this.scrollSupport&&(this.scrollSupport.inertia=e)}},decelerationRate:{get:function(){return this.scrollSupport?this.scrollSupport.decelerationRate:null},set:function(e){this.scrollSupport&&(this.scrollSupport.decelerationRate=e)}},scrollSensitivity:{get:function(){return this.scrollSupport?this.scrollSupport.scrollSensitivity:null},set:function(e){this.scrollSupport&&(this.scrollSupport.scrollSensitivity=e)}},propagationScroll:{get:function(){return this.scrollSupport?this.scrollSupport.propagationScroll:null},set:function(e){this.scrollSupport&&(this.scrollSupport.propagationScroll=e)}},horizontalScrollBar:{get:function(){return this.scrollSupport?this.scrollSupport.horizontalScrollBar:null},set:function(e){this.scrollSupport&&(this.scrollSupport.horizontalScrollBar=e)}},verticalScrollBar:{get:function(){return this.scrollSupport?this.scrollSupport.verticalScrollBar:null},set:function(e){this.scrollSupport&&(this.scrollSupport.verticalScrollBar=e)}},horizontalNormalizedPosition:{get:function(){return this.scrollSupport?this.scrollSupport.horizontalNormalizedPosition:null},set:function(e){this.scrollSupport&&this.scrollSupport.setNormalizedPosition(e,0)}},verticalNormalizedPosition:{get:function(){return this.scrollSupport?this.scrollSupport.verticalNormalizedPosition:null},set:function(e){this.scrollSupport&&this.scrollSupport.setNormalizedPosition(e,1)}}}),f.prototype.awake=function(){},f.prototype.onDestroy=function(){var e=this;e.content=null,e.cellPrefab=null,e._adapter=null,e.adapterNode=null,e._cellPool=[],e._showCell=[],e._usingCell=[]},f.prototype.update=function(){this.content&&(this.scrollSupport.pivotX=this.content.pivotX,this.scrollSupport.pivotY=this.content.pivotY),this.scrollSupport.update(this.game.time.deltaTime),this._needRebuild&&this._rebuildTable()},f.prototype.relayout=function(){this._rebuildTable()},f.prototype._clearTable=function(){var e=this,t=e.gameObject,n=e.content;n.x=0,n.y=0,e.revokeAllCell()},f.prototype.revokeAllCell=function(){var e=this,t=e.content;t.removeChildren(),Array.prototype.push.apply(e._cellPool,e._usingCell),e._usingCell=[]},f.prototype._revokeCell=function(e){var t=this;t._cellPool.push(e);var n=t._usingCell.indexOf(e);n>=0&&t._usingCell.splice(n,1)},f.prototype._createCell=function(){var e=this;if(!e._cellPrefab)return null;var t=e._cellPool.pop()||e.game.add.clone(e._cellPrefab,e.gameObject);return t&&e._usingCell.push(t),t},f.prototype._getViewRect=function(){return this.gameObject.rect},f.prototype._getContentRect=function(){var e=this,t=e.adapter,n=e.content;if(!n||!t)return new qc.Rectangle(0,0,0,0);var r=t.getTableSize(),i=r.x<Infinity?r.x-1:0,s=r.y<Infinity?r.y-1:0,o=t.getCellRect(i,s);return new qc.Rectangle(n.x,n.y,r.x<Infinity?o.x+o.width:Infinity,r.y<Infinity?o.y+o.height:Infinity)},f.prototype._setContentPosition=function(e,t){var n=this,r=n.content;if(!r)return;r.x=e,r.y=t,n._rebuildTable()},f.prototype._getViewRectInTable=function(){var e=this,t=e.gameObject,n=t.rect,r=e.content;return r?new qc.Rectangle(n.x-e.extraLeft-r.x,n.y-e.extraTop-r.y,n.width+e.extraLeft+e.extraRight,n.height+e.extraTop+e.extraBottom):new qc.Rectangle(0,0,0,0)},f.prototype._setCellRect=function(e,t,n,r,i){var s=this,o=s.content;if(!o||!e)return;e.x=t,e.y=n,e.width=r,e.height=i},f.prototype._rebuildTable=function(){var e=this,t=e.adapter,n=e.content;if(!n)return;if(!t){this._clearTable();return}var r=t.getTableSize();if(r.x<=0||r.y<=0||r.x===Infinity&&r.y===Infinity){this._clearTable();return}var i=e._getViewRectInTable(),s=e._showRect,o=i.x,u=i.x+i.width,a=i.y,f=i.y+i.height,l=t.findCellWithPos(o,a),c=t.findCellWithPos(u,f);if(!e.overflow){var h=t.findCellWithPos(o-1,a-1),p=t.findCellWithPos(u+1,f+1);h.x===l.x&&++l.x,h.y===l.y&&++l.y,p.x===c.x&&--c.x,p.y===c.y&&--c.y}var d=Math.max(l.x,0),v=Math.max(l.y,0),m=Math.min(c.x,r.x-1),g=Math.min(c.y,r.y-1),y=n.children,b=s.width*s.height;b!==y.length&&(n.removeChildren(),s.setTo(0,0,0,0),b=0);var w,E,S,x,T,N=b-1;for(E=s.y+s.height-1,x=s.y;E>=x;--E)for(S=s.x+s.width-1,T=s.x;S>=T;--S,--N){if(S>=d&&S<=m&&E>=v&&E<=g)continue;w=n.removeChildAt(N),t.revokeCell(w,S,E),e._revokeCell(w)}var C=Math.max(s.x,d),k=Math.max(s.y,v),L=Math.min(s.x+s.width-1,m),A=Math.min(s.y+s.height-1,g),O=m-d+1,M=g-v+1;if(O>0&&M>0){N=0;for(E=v;E<=g;++E)for(S=d;S<=m;++S,++N){if(S>=C&&S<=L&&E>=k&&E<=A)continue;w=e._createCell();if(!w)continue;n.addChildAt(w,N);var _=t.getCellRect(S,E);e._setCellRect(w,_.x,_.y,_.width,_.height),t.createCell(w,S,E)}}s.setTo(d,v,O,M)},f.prototype._doChildrenChanged=function(e){this._needRebuild=!0},f.prototype._doLayoutArgumentChanged=function(){this._needRebuild=!0};var l=qc.defineBehaviour("qc.Plugins.LockOrientation",qc.Behaviour,function(){var e=this;e.orientation=e.game.device.orientation,e.desktop=!1,e.runInEditor=!0,e.manualType=0},{orientation:qc.Serializer.INT,desktop:qc.Serializer.BOOLEAN,manualType:qc.Serializer.INT});l.__menu="Plugins/LockOrientation",t.defineProperties(l.prototype,{orientation:{get:function(){return this._orientation},set:function(e){if(e===this._orientation)return;this._orientation=e,this._doOrientation(this.game.device.orientation)}}}),l.prototype.awake=function(){var e=this,t=e.gameObject;e.addListener(e.game.world.onSizeChange,e._doOrientation,e),e.addListener(t.parent.onRelayout,e.assureSize,e),e._doOrientation(),e.assureSize();var n=t.parent.getScript("qc.ScaleAdapter");if(n){var r=n.getReferenceResolution;n.getReferenceResolution=function(){var t=r.call(this);return e.rotate90?new qc.Point(t.y,t.x):t}}},l.prototype.assureSize=function(){var e=this,t=e.gameObject,n=t.parent.rect;e.rotate90===!0?(t.width=n.height,t.height=n.width):(t.width=n.width,t.height=n.height),t.setAnchor(new qc.Point(.5,.5),new qc.Point(.5,.5)),t.anchoredX=0,t.anchoredY=0,t.pivotX=.5,t.pivotY=.5},l.prototype._doOrientation=function(){var e=this,t=e.gameObject,n=e.game.device.orientation;if(!e.desktop&&!e.game.editor&&e.game.device.desktop){t.rotation=0,e.rotate90=!1;return}switch(e.orientation){case qc.Device.AUTO:default:t.rotation=0,e.rotate90=!1;return;case qc.Device.PORTRAIT:case qc.Device.LANDSCAPE:n===e.orientation?(t.rotation=0,e.rotate90=!1):(t.rotation=-Math.PI/2,e.rotate90=!0),e.assureSize()}var r=t.parent.getScript("qc.ScaleAdapter");r&&(e.rotate90?e.manualType===qc.ScaleAdapter.MANUAL_WIDTH?r.manualType=qc.ScaleAdapter.MANUAL_HEIGHT:e.manualType===qc.ScaleAdapter.MANUAL_HEIGHT?r.manualType=qc.ScaleAdapter.MANUAL_WIDTH:r.manualType=e.manualType:r.manualType=e.manualType)};var c=qc.defineBehaviour("qc.dota.RotateAdapter",qc.Behaviour,function(){this.runInEditor=!0},{});c.prototype.awake=function(){var e=this;this.addListener(e.game.device.onOrientationChange,function(){e.game.device.orientation===qc.Device.LANDSCAPE?e.enable=!1:e.enable=!0},e)},c.prototype.onEnable=function(){var e=this,t=e.gameObject,n=t.getScript("qc.ScaleAdapter");n&&(e._rawGetTargetSizeFunc=n.getTargetSize,n.getTargetSize=function(){var e=this.target||this.gameObject.game.world;return!e||!e.width||!e.height?new qc.Point(0,0):new qc.Point(e.height,e.width)}),e._rawUpdateTransformFunc=e.gameObject.phaser.updateTransform,e.gameObject.phaser.updateTransform=function(){this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation));var e=this.parent.worldTransform,n=this.worldTransform,r,i,s,o,u,a;this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),r=-this._sr*this.scale.x,i=this._cr*this.scale.x,s=-this._cr*this.scale.y,o=-this._sr*this.scale.y,u=-this.position.y+t.game.world.width,a=this.position.x;if(this.pivot.x||this.pivot.y)u-=this.pivot.x*r+this.pivot.y*s,a-=this.pivot.x*i+this.pivot.y*o;n.a=r*e.a+i*e.c,n.b=r*e.b+i*e.d,n.c=s*e.a+o*e.c,n.d=s*e.b+o*e.d,n.tx=u*e.a+a*e.c+e.tx,n.ty=u*e.b+a*e.d+e.ty,this.worldAlpha=this.alpha*this.parent.worldAlpha,this.transformCallback&&this.transformCallback.call(this.transformCallbackContext,n,e);if(this._cacheAsBitmap)return;for(var f=0,l=this.children.length;f<l;f++)this.children[f].updateTransform()}},c.prototype.onDisable=function(){var e=this.gameObject,t=e.getScript("qc.ScaleAdapter");t&&this._rawGetTargetSizeFunc&&(t.getTargetSize=this._rawGetTargetSizeFunc),this._rawUpdateTransformFunc&&(this.gameObject.phaser.updateTransform=this._rawUpdateTransformFunc)};var h=qc.Serializer,p=qc.defineBehaviour("qc.demo.CombatUI",qc.Behaviour,function(){var t=this;t.startBtn=null,t.duration=0,t.pets=[],t.monsters=[],t.ult=!1,t._combating=!1,t.maskColor=new qc.Color(13421772),t.prepareEffect=null,t.myPos=0,t.oppPos=0,t.startStep=!1,e.combatUI=t},{startBtn:h.NODE,duration:h.NUMBER,pets:h.NODES,monsters:h.NODES,all:h.NODES,ult:h.BOOLEAN,maskColor:h.COLOR,prepareEffect:h.PREFAB,mask:h.NODE});t.defineProperties(p.prototype,{win:{get:function(){for(var e in this.monsters){var t=this.monsters[e].getScript("qc.demo.Fighter");if(!t.die)return!1}return!0}},lose:{get:function(){for(var e in this.pets){var t=this.pets[e].getScript("qc.demo.Fighter");if(!t.die)return!1}return!0}}}),p.prototype.awake=function(){var e=this,t=e.all.length;for(var n=0;n<t;n++){var r=e.all[n],i=r.getScript("qc.demo.Fighter");i.defensers=[];if(i.isPet){i.stepAvailable=!0,e.pets.push(r);for(var s=0;s<t;s++){var o=e.all[s].getScript("qc.demo.Fighter");o.isPet||i.defensers.push(e.all[s])}}else{e.monsters.push(r);for(var u=0;u<t;u++){var a=e.all[u].getScript("qc.demo.Fighter");a.isPet&&i.defensers.push(e.all[u])}}}e._combating||(e.startCombat(),e.startBtn.getScript("qc.TweenScale").stop(),e.startBtn.getScript("qc.TweenScale").reset())},p.prototype.startCombat=function(){var e=this;e._combating=!0,e.duration=0,e.myPos=0,e.oppPos=0;for(var t in e.pets){var n=e.pets[t].getScript("qc.demo.Fighter");n&&n.reset()}for(var t in e.monsters){var n=e.monsters[t].getScript("qc.demo.Fighter");n&&n.reset()}},p.prototype.enableUlt=function(e,t){var r=this;t=t===n?!0:t;var i=t?r.maskColor:qc.Color.white;r.mask.visible=t,e.scaleX=t?1.3:1,e.scaleY=t?1.3:1;for(var s in r.pets){var o=r.pets[s];if(o===e)continue;o.colorTint=i,o.paused=t}for(var s in r.monsters){var o=r.monsters[s];if(o===e)continue;o.colorTint=i,o.paused=t}if(t&&r.prepareEffect){var u=r.game.add.clone(r.prepareEffect,e.parent);u.onFinished.addOnce(function(){u.destroy()})}},p.prototype.onDie=function(e){var t=this,n=t.all.indexOf(e);t.all.splice(n,1);if(e.isPet){var r=t.pets.indexOf(e);t.pets.splice(r,1)}else{var i=t.monsters.indexOf(e);t.monsters.splice(i,1)}var s=0,o=0;for(var u=0;u<t.pets.length;u+=1)t.pets[u].getScript("qc.demo.Fighter").die||o++;for(var u=0;u<t.monsters.length;u+=1)t.monsters[u].getScript("qc.demo.Fighter").die||s++;console.log(o,s);if(s===0||o===0){if(o>s){for(var u in t.pets){var a=t.pets[u].getScript("qc.demo.Fighter");a&&a.letsWin()}return}for(var u in t.monsters){var a=t.monsters[u].getScript("qc.demo.Fighter");a&&a.letsWin()}}if(t.win||t.lose){t._combating=!1;return}},p.prototype.passDone=function(){var e=this;if(!e.startStep)return;var t=e.all.shift();e.all.push(t),e.startStep=!1;var n=e.all[0].getScript("qc.demo.Fighter");if(!t.getScript("qc.demo.Fighter").isPet&&n.isPet)for(var r in e.pets){var i=e.pets[r].getScript("qc.demo.Fighter");i&&(i.stepAvailable=!0)}},p.prototype.startPass=function(){this.startStep=!0};var h=qc.Serializer,d=qc.defineBehaviour("qc.demo.EffectAni",qc.Behaviour,function(){var e=this;e.type="moveFromOut",e.to=new qc.Point(0,0),e.runInEditor=!0},{type:h.STRING,to:h.POINT});d.prototype.awake=function(){var e=this,t=e.gameObject;switch(e.type){case"moveFromOut":var n=t.getScript("qc.TweenPosition");n.to=e.to,n.from.x=n.to.x-e.game.world.width/2,n.from.y=e.to.y,n.resetToBeginning(),n.playForward()}};var h=qc.Serializer,v=qc.defineBehaviour("qc.demo.EffectFly",qc.Behaviour,function(){this.offset=new qc.Point(0,0),this.left=!0},{offset:h.POINT,left:h.BOOLEAN});v.prototype.play=function(e,t){var n=this,r=e.parent,i=t.parent,s=n.gameObject.getScript("qc.TweenPosition");s.from=new qc.Point(n.gameObject.x,n.gameObject.y),n.left?s.to=new qc.Point(s.from.x+(i.x-r.x)+n.offset.x,s.from.y+(i.y-r.y)+n.offset.y):s.to=new qc.Point(s.from.x-(i.x-r.x)-n.offset.x,s.from.y+(i.y-r.y)+n.offset.y),s.playForward(),s.onFinished.addOnce(function(){n.gameObject.destroy()})};var h=qc.Serializer,m=qc.defineBehaviour("qc.demo.Fighter",qc.Behaviour,function(){var e=this;e.isPet=!0,e.uid="",e.maxHp=1e3,e.hp=e.maxHp,e.minDamage=0,e.maxDamage=0,e.frequency=3,e.freeze=0,e.skills=[],e.bigSkill=null,e.defensers=[],e.stun=!1,e.stunEffect=null,e.nextRound=m.MAX_VALUE,e.bigTime=m.SPECIAL_ATAK,e.flyDamage=null,e.twoPos=[null,null],e.icon=null,e.dieAudio=null,e.stepAvailable=!1,e.roundFinished=!1},{isPet:h.BOOLEAN,icon:h.NODE,maxHp:h.NUMBER,minDamage:h.NUMBER,maxDamage:h.NUMBER,frequency:h.NUMBER,freeze:h.NUMBER,bigSkill:h.NODE,defensers:h.NODES,stunEffect:h.PREFAB,skills:h.NODES,flyDamage:h.PREFAB,twoPos:h.NODES,dieAudio:h.AUDIO,uid:h.STRING});m.MAX_VALUE=999999999999,m.SPECIAL_ATAK=3,t.defineProperties(m.prototype,{damage:{get:function(){return this.game.math.random(this.minDamage,this.maxDamage)}},die:{get:function(){return this.hp<=0}}}),m.prototype.awake=function(){var e=this,t=e.gameObject.parent;e.oldX=t.x,e.oldY=t.y,t.visible=!1},m.prototype.update=function(){var t=this,n=t.gameObject;if(e.combatUI.ult||!e.combatUI._combating)return;if(t.die||n.paused||!n.isPlaying)return;if(t.stun)return;if(t.nextRound===m.MAX_VALUE&&t.isIdle()){t.resetRound();return}if(t.bigSkill&&!t.isPet&&t.bigTime<=0)return;t.nextRound-=t.game.time.deltaTime;var r=e.combatUI.all,i=r[0].getScript("qc.demo.Fighter");t.isIdle()&&!t.isPet&&t.uid===i.uid&&(e.combatUI.startPass(),t.bigTime>0?t.commonAttack():t.bigAttack())},m.prototype.commonAttack=function(){var e=this;e.bigTime-=1;var t=e.game.math.random(0,e.skills.length-1),n=e.skills[t],r=null;for(var i in e.defensers){var s=e.defensers[i].getScript("qc.demo.Fighter");if(s.die)continue;r=e.defensers[i];break}if(!r)return;var o=e.game.math.random(e.minDamage,e.maxDamage);n.scripts[0].play([r],o)},m.prototype.bigAttack=function(){var e=this;if(e.bigTime>0)return;e.bigTime=m.SPECIAL_ATAK,e.nextRound=m.MAX_VALUE;var t=!0;for(var n in e.defensers){if(e.defensers[n].die)continue;t=!1;break}t||e.bigSkill.scripts[0].play(e.defensers,0)},m.prototype.resetRound=function(){var e=this;e.nextRound=e.frequency*1e3},m.prototype.reset=function(){var e=this,t=e.gameObject.parent;e.hp=e.maxHp,e.stun=!1,e.bigTime=m.SPECIAL_ATAK,e.nextRound=m.MAX_VALUE,t.x=e.oldX,t.y=e.oldY,t.alpha=1;var n=e.gameObject.getScript("qc.demo.FighterAppear");n&&n.play()},m.prototype.receiveDamage=function(t,n){var r=this,i=r.gameObject;if(r.die)return;r.hp-=t;if(r.hp>0)r.isIdle()&&(i.playAnimation("damage"),i.onFinished.addOnce(function(){r.resumeIdle()}));else{i.playAnimation("death"),i.onFinished.addOnce(function(){var t=i.parent.getScript("qc.TweenAlpha");t.resetToBeginning(),t.playForward(),t.onFinished.addOnce(function(){i.parent.visible=!1,e.combatUI.onDie(i)})});if(r.dieAudio){var s=r.game.add.sound();s.audio=r.dieAudio,s.play()}}var o=null;n&&(o=r.game.add.clone(n,i.parent),o.onFinished.addOnce(function(){o.destroy()}));var u=r.game.add.clone(r.flyDamage,i.parent),a=u.getScript("qc.demo.DamageFly");return a.play(t),o},m.prototype.moveTo=function(e){var t=this;if(e!==1&&e!==2)return;var n=t.gameObject.parent,r=t._twoPos[e-1];t.gameObject.playAnimation("move",1,!0);var i=n.getScript("qc.TweenPosition");i&&(i.from=new qc.Point(n.x,n.y),i.to=r,i.duration=1.5,i.onFinished.addOnce(function(){t.resumeIdle()}),i.resetToBeginning(),i.playForward())},m.prototype.resumeIdle=function(){this.gameObject.colorTint=new qc.Color(16777215),e.combatUI.passDone();if(this.die)return;this.gameObject.playAnimation(this.gameObject.defaultAnimation,1,!0)},m.prototype.isIdle=function(){return this.die?!1:this.gameObject.lastAnimationName===this.gameObject.defaultAnimation},m.prototype.applyStun=function(e){var t=this;t.stun=!0;var n=t.game.add.clone(t.stunEffect,t.gameObject.parent);t.game.timer.add((e+1)*1e3,function(){t.stun=!1,n&&n.destroy()})},m.prototype.letsWin=function(){var e=this;e.gameObject.playAnimation("cheer",1,!0)};var h=qc.Serializer,g=qc.defineBehaviour("qc.demo.FighterAppear",qc.Behaviour,function(){var e=this;e.moveAni="move",e.offset=20,e.runInEditor=!0},{moveAni:h.STRING,offset:h.NUMBER});g.prototype.play=function(){var e=this,t=e.gameObject,r=t.getScript("qc.demo.Fighter");t.parent.visible=!0,t.alpha=1;var i=n;i?(i.to.x=t.parent.x,i.to.y=t.parent.y,i.from.y=i.to.y,r.isPet?i.from.x=i.to.x-e.game.world.width/2-e.offset:i.from.x=i.to.x+e.game.world.width/2+e.offset,i.resetToBeginning(),i.playForward(),t.playAnimation(e.moveAni,1,!0),i.onFinished.addOnce(function(){r.resumeIdle(),r.nextRound=0,r.bigTime=3})):(r.resumeIdle(),r.nextRound=0,r.bigTime=3)};var h=qc.Serializer,y=qc.defineBehaviour("qc.demo.IconInfo",qc.Behaviour,function(){var e=this;e.pet=null,e.hp=null,e.mp=null,e.effect=null,e.mask=null,e.frame=null,e.clickEffect=null},{pet:h.NODE,hp:h.NODE,mp:h.NODE,effect:h.NODE,frame:h.NODE,mask:h.NODE,clickEffect:h.PREFAB});y.prototype.awake=function(){var e=this;e.activePlay=!1,e.frame&&(e.frame.visible=!1),e.redraw()},y.prototype.onClick=function(){var t=this,n=t.pet.getScript("qc.demo.Fighter");if(n.die||n.stun||!n.isPet||!n.stepAvailable)return;if(e.combatUI.win||e.combatUI.lose)return;e.combatUI.startPass(),n.stepAvailable=!1,t.frame.visible=!1,n.bigTime>0?n.commonAttack():n.bigAttack(),t.activePlay=!1;var r=t.game.add.clone(t.clickEffect,t.gameObject);r.onFinished.addOnce(function(){r.destroy()}),this.update()},y.prototype.update=function(){this.redraw()},y.prototype.redraw=function(){var t=this,n=t.pet.getScript("qc.demo.Fighter");if(!e.combatUI._combating){t.effect.visible=!1;return}n.stepAvailable&&n.isPet&&!n.die&&(t.frame.visible=!0),t.hp.value=n.hp/n.maxHp,t.mp.value=1-Math.fround(n.bigTime/3,2);if(n.die){t.effect.visible=!1,t.gameObject.destroy();return}n.bigTime<=0&&!n.die&&n.stepAvailable?(t.effect.visible=!0,t.activePlay||(t.activePlay=!0,t.effect.playAnimation("start"),t.effect.onFinished.addOnce(function(){t.effect.playAnimation("start1",1,!0)}))):t.effect.visible=!1};var b=qc.defineBehaviour("qc.engine.SoundCtr",qc.Behaviour,function(){},{backgroundMusic:qc.Serializer.STRING});b.prototype.awake=function(){var e=this;e.game.assets.load(e.backgroundMusic,function(t){if(!t)return;var n=e.game.add.sound(e.gameObject);n.name="background music",n.audio=t,n.loop=!0,n.play()})};var w=qc.defineBehaviour("qc.demo.LoadingUI",qc.Behaviour,function(){this.clue=null},{clue:qc.Serializer.NODE});w.prototype.awake=function(){var e=this;this.addListener(e.game.scene.onStartLoad,function(){e.show()}),this.addListener(e.game.scene.onEndLoad,function(){e.gameObject.visible&&(e.duringTween?e.nextChange=1:e.hide())})},w.prototype.update=function(){var e=this,t=e.game.assets.loaded,n=e.game.assets.total;n?e.clue.text="拼命加载中："+t+"/"+n:e.clue.text="",e.gameObject.parent.setChildIndex(this.gameObject,e.gameObject.parent.children.length-1)},w.prototype.show=function(){var e=this,t=e.gameObject.getScript("qc.Plugins.NodeFadeInOut");e.gameObject.visible=!0,e.gameObject.alpha=0,t.stop(),t.enable=!1,t.target=e.gameObject.game.world,t.fadeType=r.FADE_OUT,t.fadeStyle=this.getRandomInt(0,2),t.fadeEffect=this.getRandomInt(0,3),t.pivotX=Math.random(0,1),t.pivotY=Math.random(0,1),t.columnCount=this.getRandomInt(1,32),t.rowCount=this.getRandomInt(1,32),t.resetToBeginning(),t.playForward(),e.gameObject.alpha=1,e.duringTween=!0,t.onFinished.addOnce(function(){e.duringTween=!1,e.nextChange&&(e.hide(),e.nextChange=0)})},w.prototype.hide=function(){var e=this,t=e.gameObject.getScript("qc.Plugins.NodeFadeInOut");e.gameObject.alpha=1,t.enable=!1,t.target=null,t.fadeType=r.FADE_OUT,t.fadeStyle=this.getRandomInt(0,2),t.fadeEffect=this.getRandomInt(0,3),t.pivotX=Math.random(0,1),t.pivotY=Math.random(0,1),t.columnCount=this.getRandomInt(1,32),t.rowCount=this.getRandomInt(1,32),t.resetToBeginning(),t.playForward(),e.duringTween=!0,t.onFinished.addOnce(function(){e.gameObject.visible=!1,e.duringTween=!1,e.nextChange=0})},w.prototype.getRandomInt=function(e,t){return Math.floor(Math.random()*(t-e))+e};var h=qc.Serializer,E=qc.defineBehaviour("qc.demo.DamageFly",qc.Behaviour,function(){var e=this;e.runInEditor=!0},{});E.prototype.play=function(e){var t=this,n=t.gameObject;n.text="-"+e,n.scaleDirtyInterval=0;var r=n.getScript("qc.TweenPosition");r.from.x=n.x+t.game.math.random(-30,30),r.from.y=n.y-t.game.math.random(-10,10),r.to.x=r.from.x,r.to.y=r.from.y-80,n.x=r.from.x,n.y=r.from.y;var i=n.getScript("qc.TweenScale"),s=n.getScript("qc.TweenAlpha");i.onFinished.addOnce(function(){r.resetToBeginning(),r.playForward(),s.from=1,s.to=0,s.onFinished.addOnce(function(){n.destroy()}),s.resetToBeginning(),s.playForward()}),i.resetToBeginning(),i.playForward()};var h=qc.Serializer,S=qc.defineBehaviour("qc.demo.CaptainAttack3",qc.Behaviour,function(){var e=this;e.attackAni="atk3",e.sprite=null,e.hitEffect=null,e.hitTime=1.5,e._hitCountDown=0,e.flyDistance=200,e.flyDuration=.2,e.dropTime=.3,e.audio=null,e.runInEditor=!0},{attackAni:h.STRING,sprite:h.NODE,hitTime:h.NUMBER,hitEffect:h.PREFAB,flyDistance:h.NUMBER,flyDuration:h.NUMBER,dropTime:h.NUMBER,audio:h.AUDIO});S.__menu="Dota/船长/atk3",S.prototype.awake=function(){this.enable=!1},S.prototype.update=function(){var e=this;if(e.sprite.paused)return;e._hitCountDown-=e.game.time.deltaTime,e._hitCountDown<=0&&!e.hadHit&&e.onHit()},S.prototype.play=function(e,t){var n=this;n.targets=e,n.damage=t,n.enable=!0,n.hadHit=!1,n.sprite.playAnimation(n.attackAni),n.sprite.onFinished.addOnce(function(){n.sprite.getScript("qc.demo.Fighter").resumeIdle(),n.sprite.getScript("qc.demo.Fighter").resetRound()});if(n.audio){var r=n.game.add.sound();r.audio=n.audio,r.play()}n._hitCountDown=n.hitTime*1e3},S.prototype.onHit=function(){var e=this;e.hadHit=!0,e.enable=!1;for(var t in e.targets){var n=e.targets[t].getScript("qc.demo.Fighter");if(n.die)continue;n.receiveDamage(e.damage,e.hitEffect),e.fly(e.targets[t])}},S.prototype.fly=function(e){var t=this,n=e.getScript("qc.TweenPosition");n||(n=e.addScript("qc.TweenPosition")),n.duration=t.flyDuration,n.from=new qc.Point(e.x,e.y),n.to=new qc.Point(e.x,e.y-t.flyDistance),n.resetToBeginning(),n.playForward()};var h=qc.Serializer,x=qc.defineBehaviour("qc.demo.CaptainBig",qc.Behaviour,function(){var e=this;e.attackAni="ult",e.sprite=null,e.effect=null,e.duration=.8,e.hitTime=1.5,e._hitCountDown=0,e.hitEffect=null,e.audio=null,e.runInEditor=!0},{attackAni:h.STRING,sprite:h.NODE,effect:h.PREFAB,duration:h.NUMBER,hitTime:h.NUMBER,hitEffect:h.PREFAB,audio:h.AUDIO});x.__menu="Dota/船长/big",x.prototype.awake=function(){this.enable=!1},x.prototype.update=function(){var e=this;if(e.hadHit||!e.sprite||e.sprite.paused)return;e._hitCountDown-=e.game.time.deltaTime,e._hitCountDown<=0&&e.onHit()},x.prototype.play=function(t,n){var r=this,i=r.sprite.getScript("qc.demo.Fighter");n=n||800,r.targets=t,r.damage=n,r.enable=!0,r.hadHit=!1,r.sprite.playAnimation(r.attackAni),r.sprite.onFinished.addOnce(function(){r.sprite.getScript("qc.demo.Fighter").resumeIdle(),r.sprite.getScript("qc.demo.Fighter").resetRound()}),e.combatUI.enableUlt(r.sprite,!0),r.game.timer.add(r.duration*1e3,function(){e.combatUI.enableUlt(r.sprite,!1);var t=r.game.add.clone(r.effect,r.gameObject.parent),n=t.getScript("qc.TweenPosition");n.from.x=n.to.x-r.game.world.width/2,n.resetToBeginning(),n.playForward(),n.onFinished.addOnce(function(){t.destroy()})});if(r.audio){var s=r.game.add.sound();s.audio=r.audio,s.play()}r._hitCountDown=r.hitTime*1e3},x.prototype.onHit=function(){var e=this;e.hadHit=!0,e.enable=!1;for(var t in e.targets){var n=e.targets[t].getScript("qc.demo.Fighter");if(n.die)continue;n.receiveDamage(e.damage,e.hitEffect),n.applyStun(1)}};var h=qc.Serializer,T=qc.defineBehaviour("qc.demo.CmBig",qc.Behaviour,function(){var e=this;e.attackAni="ult",e.sprite=null,e.effect=null,e.duration=.8,e.hitTime=1.5,e._hitCountDown=0,e.hitEffect=null,e.audio=null,e.runInEditor=!0},{attackAni:h.STRING,sprite:h.NODE,effect:h.PREFAB,duration:h.NUMBER,hitTime:h.NUMBER,hitEffect:h.PREFAB,audio:h.AUDIO});T.__menu="Dota/冰女/big",T.prototype.awake=function(){this.enable=!1},T.prototype.update=function(){var e=this;if(e.hadHit||!e.sprite||e.sprite.paused)return;e._hitCountDown-=e.game.time.deltaTime,e._hitCountDown<=0&&e.onHit()},T.prototype.play=function(t,n){var r=this,i=r.sprite.getScript("qc.demo.Fighter");n=n||500,r.targets=t,r.damage=n,r.enable=!0,r.hadHit=!1,r.sprite.playAnimation(r.attackAni),r.sprite.onFinished.addOnce(function(){r.sprite.getScript("qc.demo.Fighter").resumeIdle(),r.sprite.getScript("qc.demo.Fighter").resetRound()}),e.combatUI.enableUlt(r.sprite,!0),r.game.timer.add(r.duration*1e3,function(){e.combatUI.enableUlt(r.sprite,!1);var t=r.game.add.clone(r.effect,r.gameObject.parent.parent);t.playAnimation(t.defaultAnimation,.7),t.onFinished.addOnce(function(){t.destroy()})});if(r.audio){var s=r.game.add.sound();s.audio=r.audio,s.play()}r._hitCountDown=r.hitTime*1e3},T.prototype.onHit=function(){var e=this;e.hadHit=!0,e.enable=!1;var t=3,n=function(){for(var r in e.targets){var i=e.targets[r].getScript("qc.demo.Fighter");if(i.die)continue;i.receiveDamage(e.damage,e.hitEffect)}t-->0&&e.game.timer.add(150,n)};n()};var h=qc.Serializer,N=qc.defineBehaviour("qc.demo.CommonAttack",qc.Behaviour,function(){var e=this;e.attackAni="atk",e.sprite=null,e.hitEffect=null,e.flyEffect=null,e.flyEffectTime=1,e.hitTime=1.5,e._hitCountDown=0,e.hadHit=!0,e.audio=null,e.runInEditor=!0},{attackAni:h.STRING,sprite:h.NODE,hitTime:h.NUMBER,hitEffect:h.PREFAB,flyEffect:h.PREFAB,flyEffectTime:h.NUMBER,audio:h.AUDIO});N.__menu="Dota/普通攻击",N.prototype.awake=function(){this.enable=!1},N.prototype.update=function(){var e=this;if(e.hadHit||!e.sprite||e.sprite.paused)return;e._hitCountDown-=e.game.time.deltaTime,e._hitCountDown<=0&&e.onHit()},N.prototype.play=function(e,t){var n=this;n.targets=e,n.damage=t,n.enable=!0,n.hadHit=!1,n.sprite.playAnimation(n.attackAni),n.sprite.onFinished.addOnce(function(){n.sprite.getScript("qc.demo.Fighter").resumeIdle(),n.sprite.getScript("qc.demo.Fighter").resetRound()}),n.flyEffect&&n.game.timer.add(n.flyEffectTime*1e3,function(){for(var t in e){var r=n.game.add.clone(n.flyEffect,n.sprite.parent),i=r.getScript("qc.demo.EffectFly");i.play(n.sprite,e[t])}});if(n.audio){var r=n.game.add.sound();r.audio=n.audio,r.play()}n._hitCountDown=n.hitTime*1e3},N.prototype.onHit=function(){var e=this;e.hadHit=!0,e.enable=!1;for(var t in e.targets){var n=e.targets[t].getScript("qc.demo.Fighter");if(n.die)continue;n.receiveDamage(e.damage,e.hitEffect)}};var h=qc.Serializer,C=qc.defineBehaviour("qc.demo.EsBig",qc.Behaviour,function(){var e=this;e.attackAni="ult",e.sprite=null,e.effect=null,e.effectTime=1,e.duration=.8,e.hitTime=1.5,e._hitCountDown=0,e.hitEffect=null,e.audio=null,e.runInEditor=!0},{attackAni:h.STRING,sprite:h.NODE,effect:h.PREFAB,effectTime:h.NUMBER,duration:h.NUMBER,hitTime:h.NUMBER,hitEffect:h.PREFAB,audio:h.AUDIO});C.__menu="Dota/神牛/big",C.prototype.awake=function(){this.enable=!1},C.prototype.update=function(){var e=this;if(e.hadHit||!e.sprite||e.sprite.paused)return;e._hitCountDown-=e.game.time.deltaTime,e._hitCountDown<=0&&e.onHit()},C.prototype.play=function(t,n){var r=this,i=r.sprite.getScript("qc.demo.Fighter");n=n||1e3,r.targets=t,r.damage=n,r.enable=!0,r.hadHit=!1,r.sprite.playAnimation(r.attackAni),r.sprite.onFinished.addOnce(function(){r.sprite.getScript("qc.demo.Fighter").resumeIdle(),r.sprite.getScript("qc.demo.Fighter").resetRound()}),r.game.timer.add(r.effectTime*1e3,function(){var e=r.game.add.clone(r.effect,r.gameObject.parent);e.onFinished.addOnce(function(){e.destroy()})}),e.combatUI.enableUlt(r.sprite,!0),r.game.timer.add(r.duration*1e3,function(){e.combatUI.enableUlt(r.sprite,!1)});if(r.audio){var s=r.game.add.sound();s.audio=r.audio,s.play()}r._hitCountDown=r.hitTime*1e3},C.prototype.onHit=function(){var e=this;e.hadHit=!0,e.enable=!1;for(var t in e.targets){var n=e.targets[t].getScript("qc.demo.Fighter");if(n.die)continue;n.receiveDamage(e.damage,e.hitEffect)}};var h=qc.Serializer,k=qc.defineBehaviour("qc.demo.PandaBig",qc.Behaviour,function(){var e=this;e.attackAni="ult",e.sprite=null,e.duration=.8,e.hitTime=1.5,e._hitCountDown=0,e.doubleHit=[.1,.1,.1],e.flyTime=2,e.flyDistance=200,e.flyDuration=.5,e.hadHit=!0,e.audio=null,e.runInEditor=!0},{attackAni:h.STRING,sprite:h.NODE,duration:h.NUMBER,hitTime:h.NUMBER,flyDistance:h.NUMBER,flyDuration:h.NUMBER,doubleHit:h.NUMBERS,flyTime:h.NUMBER,audio:h.AUDIO});k.__menu="Dota/熊猫/big",k.prototype.awake=function(){this.enable=!1},k.prototype.update=function(){var e=this;if(e.hadHit||!e.sprite||e.sprite.paused)return;e._hitCountDown-=e.game.time.deltaTime,e._hitCountDown<=0&&e.onHit()},k.prototype.play=function(t,n){var r=this,i=r.sprite.getScript("qc.demo.Fighter");n=n||1e3;var s=null;for(var o in t)if(!t[o].getScript("qc.demo.Fighter").die){s=t[o];break}if(!s){console.error(t);return}r.targets=[s],r.damage=n,r.enable=!0,r.hadHit=!1,r.sprite.playAnimation(r.attackAni),r.sprite.onFinished.addOnce(function(){r.sprite.getScript("qc.demo.Fighter").resumeIdle(),r.sprite.getScript("qc.demo.Fighter").resetRound()}),e.combatUI.enableUlt(r.sprite,!0),r.game.timer.add(r.duration*1e3,function(){e.combatUI.enableUlt(r.sprite,!1)});if(r.audio){var u=r.game.add.sound();u.audio=r.audio,u.play()}r._hitCountDown=r.hitTime*1e3,r.game.timer.add(r.flyTime*1e3,function(){r.fly()})},k.prototype.onHit=function(){var e=this,t=e.targets[0];e.hadHit=!0,e.enable=!1;var n=-1,r=function(){var i=t.getScript("qc.demo.Fighter");if(i.die)return;i.receiveDamage(e.damage,e.hitEffect),n++,n<e.doubleHit.length&&e.game.timer.add(e.doubleHit[n]*1e3,r)};r()},k.prototype.fly=function(){var e=this,t=e.targets[0],n=t.getScript("qc.TweenPosition");n||(n=t.addScript("qc.TweenPosition")),t.die||t.playAnimation("damage"),n.from=new qc.Point(t.x,t.y),n.to=new qc.Point(n.from.x,n.from.y-e.flyDistance),n.duration=e.flyDuration,n.resetToBeginning(),n.playForward(),t.die||n.onFinished.addOnce(function(){t.getScript("qc.demo.Fighter").resumeIdle()})};var h=qc.Serializer,L=qc.defineBehaviour("qc.demo.QobBig",qc.Behaviour,function(){var e=this;e.attackAni="ult",e.sprite=null,e.effect=null,e.effectTime=1,e.duration=.8,e.hitTime=1.5,e._hitCountDown=0,e.hitEffect=null,e.audio=null,e.runInEditor=!0},{attackAni:h.STRING,sprite:h.NODE,effect:h.PREFAB,effectTime:h.NUMBER,duration:h.NUMBER,hitTime:h.NUMBER,hitEffect:h.PREFAB,audio:h.AUDIO});L.__menu="Dota/痛苦女王/big",L.prototype.awake=function(){this.enable=!1},L.prototype.update=function(){var e=this;if(e.hadHit||!e.sprite||e.sprite.paused)return;e._hitCountDown-=e.game.time.deltaTime,e._hitCountDown<=0&&e.onHit()},L.prototype.play=function(t,n){var r=this,i=r.sprite.getScript("qc.demo.Fighter");n=n||2e3,r.targets=t,r.damage=n,r.enable=!0,r.hadHit=!1,r.sprite.playAnimation(r.attackAni),r.sprite.onFinished.addOnce(function(){r.sprite.getScript("qc.demo.Fighter").resumeIdle(),r.sprite.getScript("qc.demo.Fighter").resetRound()}),r.game.timer.add(r.effectTime*1e3,function(){var e=r.game.add.clone(r.effect,r.gameObject.parent);e.onFinished.addOnce(function(){e.destroy()})}),e.combatUI.enableUlt(r.sprite,!0),r.game.timer.add(r.duration*1e3,function(){e.combatUI.enableUlt(r.sprite,!1)});if(r.audio){var s=r.game.add.sound();s.audio=r.audio,s.play()}r._hitCountDown=r.hitTime*1e3},L.prototype.onHit=function(){var e=this;e.hadHit=!0,e.enable=!1;for(var t in e.targets){var n=e.targets[t].getScript("qc.demo.Fighter");if(n.die)continue;n.receiveDamage(e.damage,e.hitEffect)}};var h=qc.Serializer,A=qc.defineBehaviour("qc.demo.TigerBig",qc.Behaviour,function(){var e=this;e.attackAni="ult",e.sprite=null,e.duration=.8,e.hitTime=1.5,e._hitCountDown=0,e.hitEffect=null,e.audio=null,e.runInEditor=!0},{attackAni:h.STRING,sprite:h.NODE,duration:h.NUMBER,hitTime:h.NUMBER,hitEffect:h.PREFAB,audio:h.AUDIO});A.__menu="Dota/老虎/big",A.prototype.awake=function(){this.enable=!1},A.prototype.update=function(){var e=this;if(e.hadHit||!e.sprite||e.sprite.paused)return;e._hitCountDown-=e.game.time.deltaTime,e._hitCountDown<=0&&e.onHit()},A.prototype.play=function(t,n){var r=this,i=r.sprite.getScript("qc.demo.Fighter");n=n||1200,r.targets=t,r.damage=n,r.enable=!0,r.hadHit=!1,r.sprite.playAnimation(r.attackAni),r.sprite.onFinished.addOnce(function(){r.sprite.getScript("qc.demo.Fighter").resumeIdle(),r.sprite.getScript("qc.demo.Fighter").resetRound()}),e.combatUI.enableUlt(r.sprite,!0),r.game.timer.add(r.duration*1e3,function(){e.combatUI.enableUlt(r.sprite,!1)});if(r.audio){var s=r.game.add.sound();s.audio=r.audio,s.play()}r._hitCountDown=r.hitTime*1e3},A.prototype.onHit=function(){var e=this;e.hadHit=!0,e.enable=!1;for(var t in e.targets){var n=e.targets[t].getScript("qc.demo.Fighter");if(n.die)continue;n.receiveDamage(e.damage,e.hitEffect)}};var h=qc.Serializer,O=qc.defineBehaviour("qc.demo.ZeusBig",qc.Behaviour,function(){var e=this;e.attackAni="ult",e.sprite=null,e.duration=.8,e.hitTime=1.5,e._hitCountDown=0,e.hitEffect=null,e.audio=null,e.runInEditor=!0},{attackAni:h.STRING,sprite:h.NODE,effect:h.PREFAB,duration:h.NUMBER,hitTime:h.NUMBER,hitEffect:h.PREFAB,audio:h.AUDIO});O.__menu="Dota/宙斯/big",O.prototype.awake=function(){this.enable=!1},O.prototype.update=function(){var e=this;if(e.hadHit||!e.sprite||e.sprite.paused)return;e._hitCountDown-=e.game.time.deltaTime,e._hitCountDown<=0&&e.onHit()},O.prototype.play=function(t,n){var r=this,i=r.sprite.getScript("qc.demo.Fighter");n=n||1200,r.targets=t,r.damage=n,r.enable=!0,r.hadHit=!1,r.sprite.playAnimation(r.attackAni),r.sprite.onFinished.addOnce(function(){r.sprite.getScript("qc.demo.Fighter").resumeIdle(),r.sprite.getScript("qc.demo.Fighter").resetRound()}),e.combatUI.enableUlt(r.sprite,!0),r.game.timer.add(r.duration*1e3,function(){e.combatUI.enableUlt(r.sprite,!1)});if(r.audio){var s=r.game.add.sound();s.audio=r.audio,s.play()}r._hitCountDown=r.hitTime*1e3},O.prototype.onHit=function(){var e=this;e.hadHit=!0,e.enable=!1;for(var t in e.targets){var n=e.targets[t].getScript("qc.demo.Fighter");if(n.die)continue;n.receiveDamage(e.damage,e.hitEffect)}}}).call(this,this,Object)